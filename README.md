# FlavorSample
Flavors Sample
<p><span style="font-size: 12pt;">이클립스때와는 달리 안드로이드 스튜디오에서는&nbsp;</span><span style="font-size: 12pt;">One Source Multi Application을 위한 기능 제공을 하고 있다.</span></p>
<p><span style="font-size: 12pt;">안드로이드 스튜디오에서 제공하는 빌드변형구성은 Flavors &nbsp;기능을 통해 여러가지 빌드형태를 제공하고&nbsp;</span></p>
<p><span style="font-size: 12pt;">Android ID를 gradle 옵션을 통해 분기시키거나, 앱아이콘, 혹은 변수까지도 변경할 수 있다.</span></p>
<p><span style="font-size: 12pt;"><br /></span></p>
<p><span style="font-size: 16px;">대표적인 사용목적</span></p>
<p><span style="font-size: 16px;">- 빌드형태에 따른 앱 분리(개발/운영 , 무료/유료)</span></p>
<p><span style="font-size: 16px;">- 여러개의&nbsp;앱을 하나의 소스로 만드는 경우</span></p>
<p><span style="font-size: 12pt;"><br /></span></p>
<p><span style="font-size: 12pt;"><br /></span></p>
<p><span style="font-size: 16px;">일단&nbsp;</span><span style="font-size: 12pt;">아래순서로 하나씩 따라해보자.</span></p>
<p><br /></p>
<p><span style="font-size: 14pt;">1.빌드변형추가</span></p>
<p><span style="font-size: 14pt;">2.리소스 분리</span></p>
<p><span style="font-size: 14pt;">3.변수 분리</span></p>
<p><span style="font-size: 14pt;">4.결과보기</span></p>
<p><br /></p>
<p><br /></p>
<p><span style="font-size: 14pt;"><b>1. 빌드변형추가 productFlavors&nbsp;</b></span></p>
<p><span style="font-size: 12pt;">일단 가장 기본인 productFlavors 를 추가한 후 gradle Sync를 해주자.</span></p>
<p><span style="font-size: 12pt;">product 키워드를 추가하고 하위에 application id , version 등을 분기하여 수정이 가능하다.</span></p>
<p><span style="font-size: 12pt;">(buildConfigField 는 3.변수분리에서 설명)</span></p><pre style="background-color:#2b2b2b;color:#a9b7c6;font-family:'Menlo';font-size:9.0pt;"><p><br /></p>
<p><span style="font-size: 10pt;">android {</span></p>
<p><span style="font-size: 10pt;">   flavorDimensions "mode"</span></p>
<p style="margin-left: 2em;"><span style="font-size: 10pt;">productFlavors {</span><br /><span style="font-size: 10pt;">    aaaa {</span><br /><span style="font-size: 10pt;">        dimension </span><span style="color:#6a8759;"><span style="font-size: 10pt;">"mode"</span><br /></span><span style="color: rgb(106, 135, 89); font-size: 10pt;">        </span><span style="font-size: 10pt;">applicationId </span><span style="color:#6a8759;"><span style="font-size: 10pt;">"com.lasselindh.aaaa"</span><br /></span><span style="color: rgb(106, 135, 89); font-size: 10pt;">        </span><span style="font-size: 10pt;">versionCode </span><span style="color:#6897bb;"><span style="font-size: 10pt;">101</span><br /></span><span style="color: rgb(104, 151, 187); font-size: 10pt;">        </span><span style="font-size: 10pt;">versionName </span><span style="color:#6a8759;"><span style="font-size: 10pt;">"1.0.1"</span><br /></span><span style="color: rgb(106, 135, 89); font-size: 10pt;">        </span><span style="font-size: 10pt;">buildConfigField </span><span style="color: rgb(106, 135, 89); font-size: 10pt;">"String"</span><span style="font-size: 10pt;">, </span><span style="color: rgb(106, 135, 89); font-size: 10pt;">"LASSELINDH"</span><span style="font-size: 10pt;">, </span><span style="color: rgb(106, 135, 89); font-size: 10pt;">"</span><span style="color: rgb(204, 120, 50); font-size: 10pt;">\"</span><span style="color: rgb(106, 135, 89); font-size: 10pt;">AAAA</span><span style="color: rgb(204, 120, 50); font-size: 10pt;">\"</span><span style="color:#6a8759;"><span style="font-size: 10pt;">"</span><br /></span><span style="color: rgb(106, 135, 89); font-size: 10pt;">        </span><span style="font-size: 10pt;">buildConfigField </span><span style="color: rgb(106, 135, 89); font-size: 10pt;">"boolean"</span><span style="font-size: 10pt;">, </span><span style="color: rgb(106, 135, 89); font-size: 10pt;">"isTrue"</span><span style="font-size: 10pt;">, </span><span style="color:#6a8759;"><span style="font-size: 10pt;">"true"</span><br /></span><span style="color: rgb(106, 135, 89); font-size: 10pt;">        </span><span style="font-size: 10pt;">buildConfigField </span><span style="color: rgb(106, 135, 89); font-size: 10pt;">"int"</span><span style="font-size: 10pt;">, </span><span style="color: rgb(106, 135, 89); font-size: 10pt;">"Type"</span><span style="font-size: 10pt;">, </span><span style="color:#6a8759;"><span style="font-size: 10pt;">"0"</span><br /></span><span style="color: rgb(106, 135, 89); font-size: 10pt;">    </span><span style="font-size: 10pt;">}</span><br /><br /><span style="font-size: 10pt;">    bbbb {</span><br /><span style="font-size: 10pt;">        dimension </span><span style="color:#6a8759;"><span style="font-size: 10pt;">"mode"</span><br /></span><span style="color: rgb(106, 135, 89); font-size: 10pt;">        </span><span style="font-size: 10pt;">applicationId </span><span style="color:#6a8759;"><span style="font-size: 10pt;">"com.lasselindh.bbbb"</span><br /></span><span style="color: rgb(106, 135, 89); font-size: 10pt;">        </span><span style="font-size: 10pt;">versionCode </span><span style="color:#6897bb;"><span style="font-size: 10pt;">102</span><br /></span><span style="color: rgb(104, 151, 187); font-size: 10pt;">        </span><span style="font-size: 10pt;">versionName </span><span style="color:#6a8759;"><span style="font-size: 10pt;">"1.0.2"</span><br /></span><span style="color: rgb(106, 135, 89); font-size: 10pt;">        </span><span style="font-size: 10pt;">buildConfigField </span><span style="color: rgb(106, 135, 89); font-size: 10pt;">"String"</span><span style="font-size: 10pt;">, </span><span style="color: rgb(106, 135, 89); font-size: 10pt;">"LASSELINDH"</span><span style="font-size: 10pt;">, </span><span style="color: rgb(106, 135, 89); font-size: 10pt;">"</span><span style="color: rgb(204, 120, 50); font-size: 10pt;">\"</span><span style="color: rgb(106, 135, 89); font-size: 10pt;">BBBB</span><span style="color: rgb(204, 120, 50); font-size: 10pt;">\"</span><span style="color:#6a8759;"><span style="font-size: 10pt;">"</span><br /></span><span style="color: rgb(106, 135, 89); font-size: 10pt;">        </span><span style="font-size: 10pt;">buildConfigField </span><span style="color: rgb(106, 135, 89); font-size: 10pt;">"boolean"</span><span style="font-size: 10pt;">, </span><span style="color: rgb(106, 135, 89); font-size: 10pt;">"isTrue"</span><span style="font-size: 10pt;">, </span><span style="color:#6a8759;"><span style="font-size: 10pt;">"true"</span><br /></span><span style="color: rgb(106, 135, 89); font-size: 10pt;">        </span><span style="font-size: 10pt;">buildConfigField </span><span style="color: rgb(106, 135, 89); font-size: 10pt;">"int"</span><span style="font-size: 10pt;">, </span><span style="color: rgb(106, 135, 89); font-size: 10pt;">"Type"</span><span style="font-size: 10pt;">, </span><span style="color:#6a8759;"><span style="font-size: 10pt;">"1"</span><br /></span><span style="color: rgb(106, 135, 89); font-size: 10pt;">    </span><span style="font-size: 10pt;">}</span><br /><span style="font-size: 10pt;">}</span></p>
<p><span style="font-size: 10pt;">}</span></p></pre><p style="text-align: left; clear: none; float: none;"><span style="font-size: 12pt;">&nbsp;gradle Sync 시 gradle 에 </span><span style="font-size: 12pt;">아래와 같이 빌드옵션이 추가되고, Build Variants 에도 추가된 빌드 옵션이 나타난다</span><span style="font-size: 12pt;">.</span></p>

<p style="text-align: left; clear: none; float: none;"><span style="font-size: 12pt;"><br /></span></p>
<p style="text-align: left; clear: none; float: none;"><span style="font-size: 12pt;"><b><span style="font-size: 14pt;">2. 리소스분리</span></b></span></p>
<p style="text-align: left; clear: none; float: none;"><span style="font-size:14pt;"><span style="font-size: 12pt;">리소스는 sourceSets 를 통해 빌드변형 키워드와 동일하게 등록하고 폴더경로는 따로 지정이 가능하다.</span><br /></span></p>
<p style="text-align: left; clear: none; float: none;"><span style="font-size: 16px;">일반적으로 sourceSets를 설정하지 않는 경우 main 과 동일 레벨로 생성되기 때문에&nbsp;</span></p>
<p style="text-align: left; clear: none; float: none;"><span style="font-size: 16px;">어플리케이션의 갯수가 많아지면 main을 찾기 어려워 질 수 있으므로 폴더를 따로 지정하여 하위에 두도록 아래와 같이 설정이 가능하다.</span></p>
<p style="text-align: left; clear: none; float: none;"><span style="font-size: 16px;">각 res 상의 string.xml , ic_launcher 등을 수정하여 앱이름, 앱 아이콘등도 변경할 수 있다.</span></p><pre style="background-color:#2b2b2b;color:#a9b7c6;font-family:'Menlo';font-size:9.0pt;"><span style="font-size: 10pt;">sourceSets {</span><br /><span style="font-size: 10pt;">    main {</span><br /><span style="font-size: 10pt;">        </span><span style="color: rgb(152, 118, 170); font-size: 10pt;">res</span><span style="font-size: 10pt;">.</span><span style="color: rgb(152, 118, 170); font-size: 10pt;">srcDirs </span><span style="font-size: 10pt;">= [</span><span style="color: rgb(106, 135, 89); font-size: 10pt;">'src/main/res'</span><span style="font-size: 10pt;">]</span><br /><span style="font-size: 10pt;">    }</span><br /><span style="font-size: 10pt;">    aaaa {</span><br /><span style="font-size: 10pt;">        </span><span style="color: rgb(152, 118, 170); font-size: 10pt;">res</span><span style="font-size: 10pt;">.</span><span style="color: rgb(152, 118, 170); font-size: 10pt;">srcDirs </span><span style="font-size: 10pt;">= [</span><span style="color: rgb(106, 135, 89); font-size: 10pt;">'src/myfolder/aaaa/res'</span><span style="font-size: 10pt;">]</span><br /><span style="font-size: 10pt;">    }</span><br /><span style="font-size: 10pt;">    bbbb {</span><br /><span style="font-size: 10pt;">        </span><span style="color: rgb(152, 118, 170); font-size: 10pt;">res</span><span style="font-size: 10pt;">.</span><span style="color: rgb(152, 118, 170); font-size: 10pt;">srcDirs </span><span style="font-size: 10pt;">= [</span><span style="color: rgb(106, 135, 89); font-size: 10pt;">'src/myfolder/bbbb/res'</span><span style="font-size: 10pt;">]</span><br /><span style="font-size: 10pt;">    }</span><br /><span style="font-size: 10pt;">}</span></pre><p style="text-align: left; clear: none; float: none;">[##_1N|cfile29.uf@999A4F3A5B343C3407BDEC.png|width="200" height="241" filename="3.png" filemime="image/jpeg" style="width: 200px; height: 241px;" original="yes"|_##]</p>
<p style="text-align: left; clear: none; float: none;"><br /></p>
<p style="text-align: left; clear: none; float: none;"><br /></p>
<p style="text-align: left; clear: none; float: none;"><br /></p>
<p></p>
<p><b><br /></b></p>
<p><span style="font-size: 14pt;"><b>3. 변수분리</b></span></p>
<p><span style="font-size: 12pt;">gradle 상에서 product에 따라 BuildConfigField를 정의 하였고</span></p>
<p><span style="font-size: 12pt;">BuildConfigFiled 는 소스상에서 아래와 같이 활용가능하다.</span></p><pre style="background-color:#2b2b2b;color:#a9b7c6;font-family:'Menlo';font-size:9.0pt;"><span style="color: rgb(204, 120, 50); font-size: 10pt;">override fun </span><span style="color: rgb(255, 198, 109); font-size: 10pt;">onCreate</span><span style="font-size: 10pt;">(savedInstanceState: Bundle?) {</span><br /><span style="font-size: 10pt;">    </span><span style="color: rgb(204, 120, 50); font-size: 10pt;">super</span><span style="font-size: 10pt;">.onCreate(savedInstanceState)</span><br /><span style="font-size: 10pt;">    setContentView(R.layout.</span><span style="color: rgb(152, 118, 170); font-style: italic; font-size: 10pt;">activity_main</span><span style="font-size: 10pt;">)</span><br /><br /><span style="font-size: 10pt;">    navigation.setOnNavigationItemSelectedListener(</span><span style="color: rgb(152, 118, 170); font-size: 10pt;">mOnNavigationItemSelectedListener</span><span style="font-size: 10pt;">)</span><br /><br /><span style="font-size: 10pt;">    tvMessage.</span><span style="color: rgb(152, 118, 170); font-style: italic; font-size: 10pt;">text </span><span style="font-size: 10pt;">= BuildConfig.</span><span style="color:#9876aa;font-style:italic;"><span style="font-size: 10pt;">LASSELINDH</span><br /></span><span style="color: rgb(152, 118, 170); font-style: italic; font-size: 10pt;">    </span><span style="color: rgb(204, 120, 50); font-size: 10pt;">if</span><span style="font-size: 10pt;">(BuildConfig.</span><span style="color: rgb(152, 118, 170); font-style: italic; font-size: 10pt;">isTrue</span><span style="font-size: 10pt;">) {</span><br /><br /><span style="font-size: 10pt;">    } </span><span style="color: rgb(204, 120, 50); font-size: 10pt;">else </span><span style="font-size: 10pt;">{</span><br /><span style="font-size: 10pt;">        </span><br /><span style="font-size: 10pt;">    }</span><br /><span style="font-size: 10pt;">    </span><span style="color: rgb(204, 120, 50); font-size: 10pt;">var </span><span style="font-size: 10pt;">type = BuildConfig.</span><span style="color:#9876aa;font-style:italic;"><span style="font-size: 10pt;">Type</span><br /></span><span style="font-size: 10pt;">}</span></pre><p><br /></p>
<p><br /></p>
<p><b style="font-size: 18.6667px;">4. 결과보기</b></p>
<p><a href="http://lasselindh.tistory.com/5" target="_blank" class="tx-link"><span style="font-size: 12pt;"><b><span style="color: rgb(255, 0, 0);">http://lasselindh.tistory.com/5</span></b></span></a><br /></p>
<p><b style="font-size: 18.6667px;"><span style="font-size: 18pt;"><br /></span></b></p>
<p><b style="font-size: 18.6667px;"><span style="font-size: 18pt;"><br /></span></b></p>
<p><span style="font-size: 24px;"><b><span style="font-size: 14pt;">난 이런거 필요없어요..단순하게 운영/개발만 분리하고 싶어요 라고 생각하시는분은&nbsp;</span></b></span></p>
<p><span style="font-size: 24px;"><b><span style="font-size: 14pt;">더욱간단한 방법이 있으니 아래 링크에서 확인하세요.</span></b></span></p>
<p><span style="font-size: 24px;"><b><span style="font-size: 14pt;"><br /></span></b></span></p>
<p><b><span style="color: rgb(0, 0, 0); font-family: 나눔고딕, NanumGothic, 돋움, Dotum, helvetica, sans-serif, tahoma; font-size: 12pt; background-color: rgb(247, 247, 247);">소스코드 수정없이 개발/운영 패키지, 앱이름, 옵션 분리하기</span><br /></b></p>


<p><a href="http://lasselindh.tistory.com/1" target="_blank" class="tx-link"><span style="font-size: 12pt;"><b><span style="color: rgb(255, 0, 0);">http://lasselindh.tistory.com/1</span></b></span></a><br /></p>
